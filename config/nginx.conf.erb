daemon off;
worker_processes auto;

events {
    use epoll;
    accept_mutex on;
    worker_connections 1024;
}

http {
    include mime.types;
    default_type application/octet-stream;

    # Optimize for static file serving
    sendfile on;
    tcp_nopush on;
    tcp_nodelay on;
    keepalive_timeout 65;
    gzip on;
    
    server {
        listen <%= ENV["PORT"] %>;
        server_name _;
        
        root /app;  # This points to the root directory where your static files are
        index index.html;
        
        # Handle static file requests
        location / {
            try_files $uri $uri/ /index.html =404;
            expires 30d;
            add_header Cache-Control "public, no-transform";
        }

        # Serve CSS files with correct MIME type
        location ~* \.css$ {
            add_header Content-Type text/css;
            expires 30d;
            add_header Cache-Control "public, no-transform";
        }

        # Error pages
        error_page 404 /404.html;
        error_page 500 502 503 504 /50x.html;
    }
}